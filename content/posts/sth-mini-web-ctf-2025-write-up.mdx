---
title: 'STH-Mini-Web-CTF-2025 ‚Äî Write Up'
date: '2025-04-6'
tags: ['CTF', 'Hacking']
description: 'Write up for the STH-Mini-Web-CTF-2025.'
---

<ImageWithCredit
  src="/images/sth-ctf-2025.png"
  alt="STH Mini Web CTF 2025"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

## üéØ Target

```
https://web1.ctf.p7z.pw
```

### ‚ö° ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢

- ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ **Flag** ‡πÇ‡∏î‡∏¢ Flag ‡∏à‡∏∞‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ‡πÄ‡∏ä‡πà‡∏ô `STH1{cff940beed74db5e1c7c63007223a6e6}`
- ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö **(Flag 1)**
- ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö **(Flag 2)**

---

## üö© Flag 1: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö

<ImageWithCredit
  src="/images/sth-flag-1-1.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏°‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤ login

> **‡∏õ‡∏±‡∏ç‡∏´‡∏≤:** ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ username, password ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∞ login ‡πÑ‡∏î‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏á?

### üìä ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

#### 1Ô∏è‚É£ ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Information Gathering)

‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏•‡∏≠‡∏á inspect ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏î‡∏π‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏à‡∏∞‡πÄ‡∏à‡∏≠‡∏≠‡∏∞‡πÑ‡∏£

<ImageWithCredit
  src="/images/sth-flag-1-2.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏≠‡∏á‡∏î‡∏π‡πÉ‡∏ô Source code ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô **comment** ‡∏Ç‡∏≠‡∏á credentials ‡∏≠‡∏¢‡∏π‡πà:

- username
- password

‡∏•‡∏≠‡∏á‡πÄ‡∏≠‡∏≤ username ‡πÅ‡∏•‡∏∞ password ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤ login ‡∏î‡∏π ‡πÅ‡∏•‡∏∞ ‡∏ï‡∏¥‡πä‡∏Å **Remember Me** ‡∏î‡πâ‡∏ß‡∏¢

<ImageWithCredit
  src="/images/sth-flag-1-3.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å login ‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£ login ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤:

- Username: `"test"`
- Role: `"user"`

<ImageWithCredit
  src="/images/sth-flag-1-4.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡πÅ‡∏ï‡πà‡πÉ‡∏ô Flag ‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á login ‡∏î‡πâ‡∏ß‡∏¢ **Admin user** ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ login ‡∏î‡πâ‡∏ß‡∏¢ Admin ‡πÑ‡∏î‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏á?

#### 2Ô∏è‚É£ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

‡∏•‡∏≠‡∏á inspect ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏î‡∏π‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏à‡∏∞‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏µ‡∏Å

<ImageWithCredit
  src="/images/sth-flag-1-5.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏≠‡∏á‡∏™‡πà‡∏≠‡∏á‡πÜ‡∏î‡∏π‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå javascript **"script.js"** ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏≤‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏°‡∏µ function ‡∏≠‡∏¢‡∏π‡πà 2 function:

‚úÖ `debugFetchUserTest()`

<ImageWithCredit
  src="/images/sth-flag-1-6.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

function ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ fetch data ‡∏à‡∏≤‡∏Å:

```
api.php?action=get_userinfo&user=test
```

‡∏•‡∏≠‡∏á‡∏¢‡∏¥‡∏á API ‡πÑ‡∏õ‡∏ó‡∏µ‡πà endpoint ‡∏ô‡∏µ‡πâ‡∏î‡∏π:

```
https://web1.ctf.p7z.pw/api.php?action=get_userinfo&user=test
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:**

<ImageWithCredit
  src="/images/sth-flag-1-7.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤ function ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô function ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á user ‡∏ô‡∏±‡πâ‡∏ô‡πÜ

‚úÖ `debugFetchAllUsers()`

<ImageWithCredit
  src="/images/sth-flag-1-8.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

function ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ fetch data ‡∏à‡∏≤‡∏Å:

```
api.php?action=get_alluser
```

‡∏•‡∏≠‡∏á‡∏¢‡∏¥‡∏á API ‡πÑ‡∏õ‡∏ó‡∏µ‡πà endpoint ‡∏ô‡∏µ‡πâ‡∏î‡∏π:

```
https://web1.ctf.p7z.pw/api.php?action=get_alluser
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:**

<ImageWithCredit
  src="/images/sth-flag-1-9.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤ function ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô function ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà fetch user ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö

#### 3Ô∏è‚É£ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Admin

‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡∏≠‡∏á function `debugFetchAllUsers()`

‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤ ‡∏°‡∏µ user ‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏µ‡∏Å 1 user ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô **admin user**

‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏•‡∏≠‡∏á‡πÄ‡∏≠‡∏≤ username ‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏¢‡∏¥‡∏á API ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á user ‡∏î‡∏π:

```
https://web1.ctf.p7z.pw/api.php?action=get_userinfo&user=admin-uat
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:**

<ImageWithCredit
  src="/images/sth-flag-1-10.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡∏î‡∏π‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô `remember_me_token` ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô token ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ sign JWT token ‡∏Ç‡∏≠‡∏á admin-uat

‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÉ‡∏ä‡πâ token ‡∏ô‡∏µ‡πâ‡∏°‡∏≤ sign token ‡πÄ‡∏û‡∏∑‡πà‡∏≠ login ‡πÄ‡∏õ‡πá‡∏ô admin-uat ‡πÑ‡∏î‡πâ

#### 4Ô∏è‚É£ ‡∏´‡∏≤ JWT Secret Key

‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ JWT secret key ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ sign token ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏´‡∏≤‡∏°‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏á?

‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ **bruteforce** ‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏´‡∏•‡πà‡∏∞!

‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡πÄ‡∏≠‡∏≤ JWT token ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô cookies:

<ImageWithCredit
  src="/images/sth-flag-1-11.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ **hashcat** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö brutefoce ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤ JWT secret key:

```bash
hashcat -a 0 -m 16500 "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbiI6ImI4MTk0M2JhLWQxYzUtNDk1YS04NDI3LTQ3MTFjMzkyNTZiZiJ9.Rlk_a69lx16hNhwn4nBfRxhiMGmEDoPIcxfr1_7JdH8" /usr/share/wordlists/rockyou.txt
```

<ImageWithCredit
  src="/images/sth-flag-1-12.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å brutefoce ‡πÄ‡∏™‡∏£‡πá‡∏à ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ß‡πà‡∏≤ JWT secret key ‡∏Ñ‡∏∑‡∏≠:

<ImageWithCredit
  src="/images/sth-flag-1-13.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

#### 5Ô∏è‚É£ ‡∏™‡∏£‡πâ‡∏≤‡∏á Token ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Login ‡πÄ‡∏õ‡πá‡∏ô Admin

‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á JWT secret key ‡πÅ‡∏•‡∏∞ token ‡πÅ‡∏•‡πâ‡∏ß

‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏≤‡∏ó‡∏±‡πâ‡∏á 2 ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏≤‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ **‡∏Å‡∏≤‡∏£ sign token** ‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ Python ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö sign token:

```python
import jwt
print(jwt.encode({ "token": "73eb7063-f8c3-4e50-bea2-07c05681aa92"}, '"bobcats"', algorithm="HS256"))
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:**

<ImageWithCredit
  src="/images/sth-flag-1-14.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

#### 6Ô∏è‚É£ Login ‡πÄ‡∏õ‡πá‡∏ô Admin

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å ‡πÑ‡∏î‡πâ JWT token ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏≠‡∏≤ token ‡πÑ‡∏õ‡πÅ‡∏Å‡πâ ‡πÉ‡∏ô cookies ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤:

<ImageWithCredit
  src="/images/sth-flag-1-15.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á refresh browser ‡∏î‡∏π ‡∏ñ‡πâ‡∏≤ user ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏´‡πâ ‡∏õ‡∏¥‡∏î browser ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡∏°‡πà ‡∏°‡∏±‡∏ô‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ï‡∏¥‡∏î cache ‡∏≠‡∏¢‡∏π‡πà
‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ login ‡∏î‡πâ‡∏ß‡∏¢ admin-uat ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß

<ImageWithCredit
  src="/images/sth-flag-1-16.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ **admin.php** ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å comment ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô script.js

<ImageWithCredit
  src="/images/sth-flag-1-17.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ admin.php ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å comment ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô script.js

<ImageWithCredit
  src="/images/sth-flag-1-18.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ admin.php ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡πá‡∏•‡∏≠‡∏á inspect ‡∏î‡∏π‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö

<ImageWithCredit
  src="/images/sth-flag-1-19.png"
  alt="STH Flag 1"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô **Flag ‡∏ó‡∏µ‡πà 1** ‡∏ñ‡∏π‡∏Å comment ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô source code üéâ

---

## üö© Flag 2: ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö

‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ inspect ‡∏´‡∏ô‡πâ‡∏≤ admin.php ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô ‡πÇ‡∏Ñ‡πâ‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å comment ‡∏≠‡∏¢‡∏π‡πà

<ImageWithCredit
  src="/images/sth-flag-2-1.png"
  alt="STH Flag 2"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

### üìä ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î

‡∏•‡∏≠‡∏á‡πÅ‡∏Å‡∏∞‡πÜ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡∏π‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤ ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö validate input ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á Flag ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤

**Logic ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏Ñ‡∏∑‡∏≠:**

1. **`validateNumber()`**

   - Regular Expression `/^[0-9]+$/m` ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ input ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
   - ‚ö†Ô∏è **‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï:** Regex ‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ `/m` ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏Ñ‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

2. **`strpos($amount, 'STH')`**
   - ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ Input ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ STH ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

### üí° ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ Bypass

‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞ bypass validator ‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÑ‡∏î‡πâ:

- Input ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î **‡πÅ‡∏•‡∏∞**
- ‡∏°‡∏µ STH ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢

‡∏£‡∏∞‡∏ö‡∏ö‡∏ñ‡∏∂‡∏á‡∏à‡∏∞ return Flag ‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤

**‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏´‡∏•‡πà‡∏∞??**

‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÑ‡∏î‡πâ Regex ‡∏ó‡∏µ‡πà validate input ‡∏°‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏Ñ‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ input ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 2 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÑ‡∏î‡πâ!

‡πÄ‡∏ä‡πà‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ:

```
12345
STH
```

- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏£‡∏Å‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢ Regex
- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 2 ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ STH

‡∏ó‡∏≥‡πÉ‡∏´‡πâ logic ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô `True && True` ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏î‡πâ Flag

### üõ†Ô∏è ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ

‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ **Burp Suite** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏¥‡∏á API ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô form ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö

<ImageWithCredit
  src="/images/sth-flag-2-4.png"
  alt="STH Flag 2"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

> ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏ä‡πâ `input type="number"` ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô input ‡πÑ‡∏î‡πâ

#### ‡∏¢‡∏¥‡∏á API ‡∏î‡πâ‡∏ß‡∏¢ Burp Suite

‡∏™‡πà‡∏á payload:

```
amount=123%0ASTH&denomination=USD
```

‡πÇ‡∏î‡∏¢:

- `12345` ‡∏Ñ‡∏∑‡∏≠ ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ú‡πà‡∏≤‡∏ô regex
- `%0A` ‡∏Ñ‡∏∑‡∏≠ `\n` ‡πÅ‡∏ö‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™ (URL encoding)
- `STH` ‡∏Ñ‡∏∑‡∏≠ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏£‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô payload ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ flag

<ImageWithCredit
  src="/images/sth-flag-2-2.png"
  alt="STH Flag 2"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

### üéØ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏¢‡∏¥‡∏á API ‡πÑ‡∏õ ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô **Flag ‡∏ó‡∏µ‡πà 2** ‡πÉ‡∏ô Response:

<ImageWithCredit
  src="/images/sth-flag-2-3.png"
  alt="STH Flag 2"
  credit="https://web1.ctf.p7z.pw"
  width={800}
  height={800}
/>

## üèÜ ‡∏™‡∏£‡∏∏‡∏õ

‡∏ó‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏î‡πâ Flag ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 2 Flag ‡πÅ‡∏•‡πâ‡∏ß! üéâüéâüéâ

1. **Flag 1:** ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏≠‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏õ‡πá‡∏ô admin ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ö JWT token
2. **Flag 2:** ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ bypass validation ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ newline character
